<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.sdpzhong.dev.mapper.ArticleMapper">

    <resultMap id="BaseResultMap" type="com.sdpzhong.dev.entity.po.Article">
        <id property="id" column="id" jdbcType="BIGINT"/>
        <result property="uid" column="uid" jdbcType="VARCHAR"/>
        <result property="channelId" column="channel_id" jdbcType="BIGINT"/>
        <result property="title" column="title" jdbcType="VARCHAR"/>
        <result property="subtitle" column="subtitle" jdbcType="VARCHAR"/>
        <result property="content" column="content" jdbcType="VARCHAR"/>
        <result property="cover" column="cover" jdbcType="VARCHAR"/>
        <result property="readCount" column="read_count" jdbcType="INTEGER"/>
        <result property="keywords" column="keywords" jdbcType="VARCHAR"/>
        <result property="status" column="status" jdbcType="INTEGER"/>
        <result property="submitTime" column="submit_time" jdbcType="TIMESTAMP"/>
        <result property="publishTime" column="publish_time" jdbcType="TIMESTAMP"/>
        <result property="createTime" column="create_time" jdbcType="TIMESTAMP"/>
        <result property="updateTime" column="update_time" jdbcType="TIMESTAMP"/>
        <result property="deleted" column="deleted" jdbcType="INTEGER"/>

        <!-- author 对应用户表信息 -->
        <association property="author" javaType="com.sdpzhong.dev.entity.po.UserSimplePo">
            <id column="userId" property="uid"/>
            <id column="username" property="username"/>
            <id column="gender" property="gender"/>
            <id column="sign" property="sign"/>
            <id column="email" property="email"/>
        </association>
    </resultMap>

    <sql id="Base_Column_List">
        id,channel_id,uid
        title,subtitle,
        content,cover,read_count,
        keywords,status,submit_time,
        publish_time,create_time,update_time,
        deleted,
    </sql>

    <!--  获取文章分页 联表查询获取作者信息  -->
    <select id="queryArticlePage" resultMap="BaseResultMap">
        select ta.id,
               ta.channel_id,
               ta.title,
               ta.subtitle,
               ta.content,
               ta.cover,
               ta.read_count,
               ta.keywords,
               ta.status,
               ta.submit_time,
               ta.publish_time,
               ta.create_time,
               ta.update_time,
               ta.uid as uid,
               tu.uid as userId,
               tu.username,
               tu.gender,
               tu.sign,
               tu.email
        from t_article as ta,
             t_user as tu
        where ta.deleted = 0
    </select>

</mapper>
